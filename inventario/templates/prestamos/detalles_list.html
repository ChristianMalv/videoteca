{% extends '__basePrestamos.html' %}
{% block content %}

<table id="detalleTabla" class="table table-striped table-bordered  table-responsive dataTable_width_auto display" style="width:100%">
    <thead>
        <tr>
            <th>Info</th>
            <th>Folio Pr√©stamo</th>
            <th>Usuario</th>
            <th>Fecha Vencimiento.</th>
        </tr>
    </thead>
    <tbody>
      {% for data in prestamos %}
      <tr>
          <td></td>
          {% comment %} <td {% if data.pres_fechahora < hace_siete_dias %}class="alert-warning"{% elif data.pres_fechahora > hace_siete_dias and data.pres_fechahora < fecha_actual %}class="alert-info"{% endif %}>
              {{ data.pres_folio }}
          </td>
          <td {% if data.pres_fechahora < hace_siete_dias %}class="alert-warning"{% elif data.pres_fechahora > hace_siete_dias and data.pres_fechahora < fecha_actual %}class="alert-info"{% endif %}>
              {{ data.usua_clave }}
          </td> {% endcomment %}
          <td> {{data.pres_folio}} </td>
          <td> {{data.usua_clave}} </td>
          <td>
              {% if data.pres_fechahora < hace_siete_dias %}
                  <div class="alert alert-warning">{{ data.pres_fechahora }}</div>
              {% elif data.pres_fechahora > hace_siete_dias and data.pres_fechahora < fecha_actual %}
                  <div class="alert alert-info">{{ data.pres_fechahora }}</div>
              {% else %}
                  {{ data.pres_fechahora }}
              {% endif %}
          </td>
      </tr>
      {% empty %}
      {% endfor %}
  </tbody>
</table>

{% comment %} Modal Listar Cintas {% endcomment %}

<div class="modal fade" id="modalCintas">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title mb-3">
          <div style="display: flex; flex-direction: column; align-items: center;">
            <span>Usuario Prestamo</span>
            <i class='fas fa-handshake'></i>
          </div>
        </h4>
        <input type="text" id="inputDetalles" disabled>
    </div>
    <div class="modal-body" style="overflow-y: auto; max-height: 500px;">
      <div class="modal-body" id="muestraData" >
        <table class="table table-bordered" id="muestraDataTable" name="DataTable">
          <thead>
            <tr>
             {% comment %} Esta tabla se pinta en el jquery {% endcomment %}
            </tr>
          </thead>
          <tbody>
            <form>
              <div class="form-group row">
                  <label class="col-md-2 col-form-label">Nombre Completo</label>
                  <div class="col-md-5 mb-1">
                      <input type="text" disabled autocomplete="off" class="form-control" id="">
                  </div>
              </div>
          
              <div class="form-group row">
                  <label class="col-md-2 col-form-label">Matricula</label>
                  <div class="col-md-3 mb-1">
                      <input type="text" disabled autocomplete="off" class="form-control" id="">
                  </div>
              </div>
          
              <div class="form-group row">
                  <label class="col-md-2 col-form-label">Puesto</label>
                  <div class="col-md-3 mb-1">
                      <input type="text" disabled autocomplete="off" class="form-control form-control-sm" id="">
                  </div>
                  <label class="col-md-2 col-form-label text-md-end">Ext.</label>
                  <div class="col-md-3 mb-1">
                      <input type="text" disabled autocomplete="off" class="form-control" id="">
                  </div>
              </div>
            </form>
          </tbody> 
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default btn-sm active" data-dismiss="modal" id="closeModal"><i class="fa fa-reply-all"></i> Salir </button>
        <button type="button" class="btn btn-primary btn-sm active" id=""><i class="fas fa-file-pdf" ></i> Vigente | Expiro </button>
      </div>
    </div>
  </div>
  </div>
</div> 
{% comment %}  {% endcomment %}
<br>
<br>

<script>

  $(document).ready(function() {
    $('#detalleTabla').DataTable({
        ...columns,
        autoFill: {
            columns: [3] 
        },
        columns: [
            {
              "data": "pres_folio",
              "render": function(data, type, row, meta) {
                  return "<a class='ver-detalle' data-folio='" + data + "' data-toggle='modal' data-target='#modalCintas'><i class='fa-sharp fa-solid fa-info-circle' style='color:#9D2449'></i></a>";
              }
            },
            { "data": "pres_folio" },
            { "data": "usua_clave" },
            { "data": "pres_fechahora" },
        ],
        createdRow: function(row, data, dataIndex) {
            $(row).data('folio', data.pres_folio);
        }
    });

    $(document).on('click', '.ver-detalle', function() {
      let folio = $(this).data('folio');
      $('#inputDetalles').val(`No. de Folio: ${folio}`);
  });
  
});


</script>

<style>
    .detalle ul {
        display: none;
    }
</style>
{% endblock %}
